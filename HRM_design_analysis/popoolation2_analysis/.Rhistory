library("RCurl", lib.loc="C:/Program Files/R/R-3.0.2/library")
all <- scp("genome3.pfr.co.nz","/workspace/genome_analysis/plant/Allium/cepa/NXD_sample_align/35.cmh_test_all/All_bolt_assoc.cmh.params",rsa=TRUE,user="cfljam",key=sprintf(c("C:\\Program Files (x86)/WinSCP/PuTTY/craptop2013.ppk")),binary=FALSE )
column_names <-c("BoltA1_RG.bam",
"BoltA2_RG.bam",
"BoltA3_RG.bam",
"BoltB1_RG.bam",
"BoltB2_RG.bam",
"BoltB3_RG.bam",
"NonA1_RG.bam",
"NonA2_RG.bam",
"NonA3_RG.bam",
"NonB1_RG.bam",
"NonB2_RG.bam",
"NonB3_RG.bam")
all_bolt <- read.table('All_bolt_assoc.cmh',col.names=c("chrom","pos","ref_base",column_names,"pval"))
library(ggplot2)
hist_all_pval <- ggplot(all_bolt,aes(x=pval)) + geom_histogram()
hist_all_pval
library("qvalue", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
qobj <- qvalue(all_bolt$pval)
qplot(qobj)
qvalue.gui()
summary.qvalue(qval)
summary.qvalue(qobj)
qobj <- qvalue(all_bolt$pval,pi0.meth=“bootstrap”)
qobj <- qvalue(all_bolt$pval,pi0.meth=“bootstrap”)
qplot(qobj)
summary.qvalue(qobj)
qplot(qobj)
qplot(qobj)
max(qobj$pvalues[qobj$qvalues <= 0.05])
max(qobj$pvalues[qobj$qvalues <= 0.01])
summary(qobj)
qobj$pi0
pval-cutoff <-max(qobj$pvalues[qobj$qvalues <= 0.05])
pval_cutoff <-max(qobj$pvalues[qobj$qvalues <= 0.05])
pval_cutoff
?len
?length
length(all_bolt[which(all_bolt$pval < pval_cutoff)],)
length(all_bolt[which(all_bolt$pval < pval_cutoff)])
which(all_bolt$pval < pval_cutoff)
length(which(all_bolt$pval < pval_cutoff))
length(which(all_bolt$pval < max(qobj$pvalues[qobj$qvalues <= 0.01])))
length(which(all_bolt$pval < max(qobj$pvalues[qobj$qvalues <= 0.005])))
length(which(all_bolt$pval < pval_cutoff))
head(all_bolt[which(all_bolt$pval < pval_cutoff)),])
all_bolt[which(all_bolt$pval < pval_cutoff)),]
detach("package:qvalue", unload=TRUE)
all_bolt[which(all_bolt$pval < pval_cutoff)),]
all_bolt[which(all_bolt$pval < pval_cutoff)),2]
sig <- all_bolt[which(all_bolt$pval < pval_cutoff)),]
sig <- all_bolt[which(all_bolt$pval < pval_cutoff)),]
length(which(all_bolt$pval < pval_cutoff))
all_bolt[which(all_bolt$pval < pval_cutoff),]
sig <-all_bolt[which(all_bolt$pval < pval_cutoff),]
View(sig)
summary(sig$chrom)
levels(sig$chrom)
??drop
levels(droplevels(sig$chrom))
acp267_LD <- read.table('ACP267_LD.cmh.bz2',col.names=c("chrom","pos","ref_base",column_names,"pval"))
Bolt_notACP267 <-read.table('Bolt_notACP267_LD_assoc.cmh.bz2',,col.names=c("chrom","pos","ref_base",column_names,"pval"))
hist_all_pval <- ggplot(all_bolt,aes(x=pval)) + geom_histogram() + ggtitle('all')
hist_all_pval
hist_ACP_pval <- ggplot(acp267_LD,aes(x=pval)) + geom_histogram() + ggtitle('ACP267')
hist_NotACP_pval <- ggplot(Bolt_notACP267,aes(x=pval)) + geom_histogram() + ggtitle('NotACP267')
hist_ACP_pval
hist_NotACP_pval
acp_qobj <- qvalue(acp267_LD$pval,pi0.meth=“bootstrap”)
head(acp267_LD$pval)
all_qobj <- qvalue(all_bolt$pval,pi0.meth=“bootstrap”)
acp_qobj <- qvalue(acp267_LD$pval,pi0.meth=“bootstrap”)
library("qvalue", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
all_qobj <- qvalue(all_bolt$pval,pi0.meth=“bootstrap”)
all_qobj <- qvalue(all_bolt$pval)
all_qobj <- qvalue(all_bolt$pval,pi0.meth=“bootstrap”)
acp_qobj <- qvalue(acp267_LD$pval)
summary(acp_qobj)
summary(all_qobj)
nonACP_qobj  <- qvalue(Bolt_notACP267$pval)
summary(nonACP_qobj)
max(all_qobj$pvalues[qobj$qvalues <= 0.05])
max(nonACP_qobj$pvalues[qobj$qvalues <= 0.05])
max(acp_qobj$pvalues[qobj$qvalues <= 0.05])
qplot(nonACP_qobj)
qplot(acp_qobj)
qplot(all_qobj)
max(all_qobj$pvalues[all_qobj$qvalues <= 0.05])
max(acp_qobj$pvalues[acp_qobj$qvalues <= 0.05])
max(nonACP_qobj$pvalues[acp_qobj$qvalues <= 0.05])
max(nonACP_qobj$pvalues[nonACP_qobj$qvalues <= 0.05])
FDR <- 0.01
FDR <- 0.01
max(all_qobj$pvalues[all_qobj$qvalues <= FDR])
max(acp_qobj$pvalues[acp_qobj$qvalues <= FDR])
max(nonACP_qobj$pvalues[nonACP_qobj$qvalues <= FDR])
pval_cutoff <- max(acp_qobj$pvalues[acp_qobj$qvalues <= FDR])
min(all_bolt$pval)
which(all_bolt$pval==min(all_bolt$pval))
all_bolt[which(all_bolt$pval==min(all_bolt$pval),]
all_bolt[241631]
all_bolt[241631,]
acp267_LD[241631,]
Bolt_notACP267[241631,]
all_bolt[which(all_bolt$chrom=="JR844971"),]
all_bolt[which(all_bolt$pval < 1e-20),]
?cbind
head(all_bolt)
test1 <- head(all_bolt)
test1 <- rename(head(all_bolt),c(pval="all_pval")
)
test1 <- rename(head(all_bolt),c(pval="all_pval"))
test1 <- rename(test1,c(pval="all_pval"))
View(test1)
test1 <- rename(test1,c(pval="all_pval"))
names(test1)
install.packages("rehape")
install.packages("reshape")
test1 <- rename(test1,c(pval="all_pval"))
names(test1)
library(reshape)
test1 <- rename(test1,c(pval="all_pval"))
names(test1)
test2 <- head(Bolt_notACP267)
test2 <- rename(test2,c(pval="not_pval"))
names(test2)
cbind(test1,test2$not_pval)
View(acp267_LD)
View(acp267_LD)
head(all_bolt, acp267_LD$pval)
head(cbind(all_bolt, acp267_LD$pval))
combined <- cbind(all_bolt,acp267_LD$pval,Bolt_notACP267$pval)
View(combined)
plot(-log(combined$acp267_LD$pval),-log(combined$pval))
ggplot(combined,aes(x=pval)) + geom_point(aes(y=acp267_LD$pval))
ggplot(combined,aes(x=-log(pval)) + geom_point(aes(y=-log(acp267_LD$pval)))
)
ggplot(combined,aes(x=-log(pval))) + geom_point(aes(y=-log(acp267_LD$pval)))
ggplot(combined,aes(x=-log(Bolt_notACP267$pval))) + geom_point(aes(y=-log(acp267_LD$pval)))
?log10
ggplot(combined,aes(x=-log10(Bolt_notACP267$pval))) + geom_point(aes(y=-log10(acp267_LD$pval)))
ggplot(combined,aes(x=-log10(Bolt_notACP267$pval))) + geom_point(aes(alpha=-log10(pval),y=-log10(acp267_LD$pval)))
attach(combined)
sig_all <- pval < pval_cutoff
sig_ACP267 <- pval < pval_cutoff
names(combined)
detach(combined)
sig_all <- all_bolt$pval < pval_cutoff
sig_ACP267 <- acp267_LD$pval < pval_cutoff
c3 < cbind(sig_all,sig_ACP267,sig_BoltnotACP267)
c3 <- cbind(sig_all,sig_ACP267,sig_BoltnotACP267)
head(sig_all)
cbind(sig_all,sig_ACP267)
cbind(sig_all,sig_ACP267,sig_BoltnotACP267)
head(BoltnotACP267)
Bolt_notACP267$pval
Bolt_notACP267$pval < pval_cutoff
sig_BoltnotACP267 <- Bolt_notACP267$pval < pval_cutoff
c3 <- cbind(sig_all,sig_ACP267,sig_BoltnotACP267)
biocLite("limma")
source("http://www.bioconductor.org/biocLite.R")
biocLite("limma")
library("limma", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
a <- vennCounts(c3)
vennDiagram(a)
View(`c3`)
?not
??not
which(c3,!sig_all)
which(c3,!sig_all && !sig_ACP267 )
which(c3,!sig_all && !sig_ACP267 && sig_BoltnotACP267 )
!sig_all && !sig_ACP267 && sig_BoltnotACP267 )
which(c3,!sig_all && !sig_ACP267 && sig_BoltnotACP267)
length(which(c3,!sig_all && !sig_ACP267 && sig_BoltnotACP267))
length(which(c3,!sig_all))
length(which(c3,sig_all))
length(which(c3,sig_ACP267))
sig_all <- all_bolt$pval < pval_cutoff
summary(sig_all)
summary(sig_ACP267)
summary(sig_BoltnotACP267)
which(c3,name)
names(c3)
a
head(a)
colnames(c3)
as.data.frame(c3)
which(as.data.frame(c3),sig_all)
summary(c3)
c3[which(c3[sig_all])]
head(cbind(combined,c3))
combined <- cbind(combined,c3)
View(combined)
combined$sig_all
combined[which(combined$sig_all),]
combined[which(combined$sig_BoltnotACP267 && combined$sig_ACP267),]
combined[which(combined$sig_BoltnotACP267 & combined$sig_ACP267),]
combined[which(combined$sig_BoltnotACP267 ! combined$sig_ACP267),]
combined[which(combined$sig_BoltnotACP267 & combined$sig_ACP267),]
combined[which(combined$sig_BoltnotACP267 & !combined$sig_ACP267),]
combined[which(combined$sig_BoltnotACP267 & !combined$sig_ACP267) & !combined$sig_all,]
combined[which(combined$sig_BoltnotACP267 & !combined$sig_ACP267 & !combined$sig_all),]
?kable
??kable
library("knitr", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
kable(combined[which(combined$sig_BoltnotACP267 & !combined$sig_ACP267 & !combined$sig_all),],"html")
kable(as.data.frame(combined[which(combined$sig_BoltnotACP267 & !combined$sig_ACP267 & !combined$sig_all),]),"html")
combined[which(combined$sig_BoltnotACP267 & !combined$sig_ACP267 & !combined$sig_all),]
View(combined)
View(combined)
head(aggregate(combined,by=chrom,))
attach(mtcars)
head(mtcars)
aggdata <-aggregate(mtcars, by=list(cyl,vs),
FUN=mean, na.rm=TRUE)
print(aggdata)
?aggregate
View(combined)
test<-aggregate(combined,by=chrom,FUN=min)
test<-aggregate(combined,by=list(chrom),FUN=min)
?min
head(combined['pval'])
head(combined['chrom',pval'])
''
head(combined['chrom','pval'])
head(combined[c('chrom','pval')])
aggregate(combined[c('chrom','pval')], by=list(chrom),Fun=min)
aggregate(combined[c('chrom','pval')], by=chrom,Fun=min)
test <- (combined[c('chrom','pval')])
?hed
?head
test <- head(combined[c('chrom','pval')],1000)
head(test)
aggregate(test,by=list(chrom),FUN=min)
head(mtcars)
summary(test)
test <- head(combined[c('chrom','pval','acp267_LD$pval')],1000)
summary(test)
aggregate(test,by=chrom,FUN=min)
aggregate(test,by=list(chrom),FUN=min)
head(aggregate(mtcars,by=cyl,FUN=min))
head(aggregate(mtcars,by=cyl,FUN=mean))
head(aggregate(mtcars,by=cyl,FUN=mean,na.rm=TRUE))
head(aggregate(mtcars,by=list(cyl),FUN=mean,na.rm=TRUE))
head(aggregate(mtcars,by=list(cyl),FUN=mean))
head(aggregate(mtcars,by=list(cyl),FUN=min))
head(aggregate(test))
head(aggregate(test),by=list(chrom),fun=mean)
head(aggregate(mtcars[c('cyl','gear')],by=list(cyl),FUN=min))
head (test)
head(test)
head(mtcars
)
head(aggregate(test,by=list(as.factor(chrom)),fun=mean)
)
head(aggregate(test,by=list(as.factor(chrom)),fun=mean)
)
head(aggregate(test,by=list(as.factor(chrom)),fun=mean))
test
?summary
test <- as.data.frame(test)
head(aggregate(test,by=list(as.factor(chrom)),fun=mean))
aggregate(test,by=list(chrom),fun=mean)
head(aggregate(test,by=list(as.factor(chrom)),fun=mean))
rep(2,3)
rep("foo",3)
rep(c("foo","bar",3)
""
rep(c("foo","bar"),3)
seq(2,6)
seq(1,6)
cbind(seq(2,6),rep(c("foo","bar"),3))
as.data.frame(cbind(seq(2,6),rep(c("foo","bar"),3)))
temp <-as.data.frame(cbind(seq(2,6),rep(c("foo","bar"),3)))
temp
addgregate(temp,by=V1,FUN=min)
addgregate(temp,by=list(V1),FUN=min)
addgregate(temp,by=list('V1'),FUN=min)
names(temp)
aggregate(temp,by=list(V1),FUN=min)
aggregate(temp,by=V1,FUN=min)
aggregate(temp,by=list(V1),FUN=mean)
?random
?ran
??random
sample(6)
cbind(temp,sample(6))
temp <-as.data.frame(cbind(seq(2,6),sample(6)rep(c("foo","bar"),3)))
temp <-as.data.frame(cbind(seq(2,6),sample(6),rep(c("foo","bar"),3)))
temp
aggregate(temp,by=list(V1,V3),FUN=min)
head(mtcars)
colnames(temp)
colnames(temp)=c('a','b','c')
colnames(temp)
temp$a
temp <-as.data.frame(cbind(as.numeric(seq(2,6)),sample(6),rep(c("foo","bar"),3)))
summary(temp)
temp <-as.data.frame(cbind(as.numeric(seq(2,6)),sample(6),rep(c("foo","bar"),3)))
summary(temp)
mean(temp$V1)
mean(as.numeric(temp$V1)
)
summary(combined)
head(combined[1:2])
head(combined[c(1,2)])
head(combined[c(1,2,11)])
head(combined[c(1,2,13)])
head(combined[c(1,2,15)])
head(combined[c(1,2,16)])
head(combined[c(1,2,16:18)])
head(combined[c(1,2,16:21)])
head(combined[c(1,2,16:18)])
head(combined[c(1,16:18)])
aggregate(combined[c(1,16:18)],by=list(chrom),FUN=min)
combined[c(1,16:18)]
test <- combined[c(1,16:18)]
summary(test)
aggregate(combined[c(1,16:18)],by=list(chrom),FUN=mean)
?aggregate
aggregate.data.frame(combined[c(1,16:18)],by=list(chrom),FUN=mean)
aggregate(test,by=list(chrom),FUN=mean)
head(test)
aggregate(test,list(contig=chrom),mean)
aggregate(head(test,1000),list(contig=chrom),mean)
aggregate(pval ~ chrom,data=test, mean)
aggregate(pval ~ chrom,data=test, min)
length(aggregate(pval ~ chrom,data=test, min))
aggregate(pval ~ chrom,data=test, min)
out <-aggregate(pval ~ chrom,data=test, min)
summary(temp)
summary(test
)
levels(test$chrom)
length(levels(test$chrom))
head(aggregate(data=combined,pval ~ chrom,min))
head(aggregate(data=combined,cbind(pval,acp267_LD$pval) ~ chrom,min))
head(aggregate(data=combined,cbind(pval,acp267_LD$pval,Bolt_notACP267$pval) ~ chrom,min))
by_contig <- aggregate(data=combined,cbind(pval,acp267_LD$pval,Bolt_notACP267$pval) ~ chrom,min))
by_contig <- aggregate(data=combined,cbind(pval,acp267_LD$pval,Bolt_notACP267$pval) ~ chrom,min)
column_names(by_contig)
colnames(by_contig)
colnames(by_contig) <- c("chrom", "all_pval","ACP267_pval","NotACP267_pval")
by_contig$sig_all <- by_contig$all_pval < pval_cutoff
View(by_contig)
by_contig$sig_acp267 <- by_contig$ACP267_pval < pval_cutoff
by_contig$sig_nonACP <- by_contig$NotACP267_pval < pval_cutoff
View(by_contig)
head(by_contig)
head(by_contig[5-7])
head(by_contig[5:7])
a <- vennCounts(by_contig[5:7])
vennDiagram(a)
View(by_contig)
ggplot(by_contig,aes(x=-log10(ACP267_pval) + geom_point(aes(alpha=-log10(all_pval),y=-log10(all_pval)))
""
ggplot(by_contig,aes(x=-log10(ACP267_pval))) + geom_point(aes(alpha=-log10(all_pval),y=-log10(all_pval)))
ggplot(by_contig,aes(x=-log10(ACP267_pval))) + geom_point(aes(alpha=-log10(NotACP267_pval),y=-log10(all_pval)))
ggplot(by_contig,aes(x=-log10(ACP267_pval))) + geom_point(aes(alpha=-log10(all_pval),y=-log10(NotACP267_pval)))
vennDiagram(a)
?vennDiagram
FDR <- 0.01
max(all_qobj$pvalues[all_qobj$qvalues <= FDR])
max(acp_qobj$pvalues[acp_qobj$qvalues <= FDR])
max(nonACP_qobj$pvalues[nonACP_qobj$qvalues <= FDR])
pval_cutoff <- max(acp_qobj$pvalues[acp_qobj$qvalues <= FDR])
by_contig <- aggregate(data=combined,cbind(pval,acp267_LD$pval,Bolt_notACP267$pval) ~ chrom,min)
colnames(by_contig) <- c("chrom", "all_pval","ACP267_pval","NotACP267_pval")
by_contig$sig_all <- by_contig$all_pval < max(all_qobj$pvalues[all_qobj$qvalues <= FDR])
by_contig$sig_acp267 <- by_contig$ACP267_pval < max(acp_qobj$pvalues[acp_qobj$qvalues <= FDR])
by_contig$sig_nonACP <- by_contig$NotACP267_pval < max(nonACP_qobj$pvalues[nonACP_qobj$qvalues <= FDR])
library("limma", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
a <- vennCounts(by_contig[5:7])
vennDiagram(a)
ggplot(by_contig,aes(x=-log10(ACP267_pval))) + geom_point(aes(alpha=-log10(all_pval),y=-log10(NotACP267_pval))) + ggtitle('Contig minimum CMH test pvalue')
ggplot(by_contig,aes(x=-log10(ACP267_pval))) + geom_point(aes(alpha=-log10(all_pval),y=-log10(NotACP267_pval))) + ggtitle('Contig minimum CMH test pvalue') + coord_fixed()
max(all_qobj$pvalues[all_qobj$qvalues <= FDR])
FDR <- 0.01
max(all_qobj$pvalues[all_qobj$qvalues <= FDR])
max(acp_qobj$pvalues[acp_qobj$qvalues <= FDR])
max(nonACP_qobj$pvalues[nonACP_qobj$qvalues <= FDR])
